# 7. 管道、环境变量与常用命令

**目录：**

[TOC]

---

## 一、管道

### 1.1 概念

管道类似于文件重定向，可以将前一个命令的 `stdout` 重定向到下一个命令的 `stdin`。

### 1.2 要点

管道的要点如下所示：
1. 管道命令仅处理 `stdout`，会忽略 `stderr`。
2. 管道右边的命令必须能接受 `stdin`。
3. 多个管道命令可以串联。

### 1.3 与文件重定向的区别

管道与文件重定向的区别如下所示：
* 文件重定向左边为命令，右边为文件。
* 管道左右两边均为命令，左边有 `stdout`，右边有 `stdin`。

### 1.4 举例

统计当前目录下所有 Python 文件的总行数：
```bash
find . -name '*.py' | xargs cat | wc -l
```

其中 `find`、`xargs`、`wc` 等命令可以参考 常用命令 这一节内容。

## 二、环境变量

### 2.1 概念

Linux 系统中会用很多环境变量来记录配置信息。

环境变量类似于全局变量，可以被各个进程访问到。我们可以通过修改环境变量来方便地修改系统配置。

### 2.2 查看

列出当前环境下的所有环境变量：
```bash
env # 显示当前用户的变量
set # 显示当前 shell 的变量，包括当前用户的变量
export  # 显示当前导出成用户变量的 shell 变量
```

输出某个环境变量的值：
```bash
echo $PATH
```

### 2.3 修改

环境变量的定义、修改、删除操作可以参考《3. shell 语法——变量》这一节的内容。

为了将对环境变量的修改应用到未来所有环境下，可以将修改命令放到 `~/.bashrc` 文件中。

修改完 `~/.bashrc` 文件后，记得执行 `source ~/.bashrc`，来将修改应用到当前的 `bash` 环境下。

> 拓展：
>
> 为何将修改命令放到 `~/.bashrc`，就可以确保修改会影响未来所有的环境呢？
> * 每次启动 `bash`，都会先执行 `~/.bashrc`；
> * 每次 `ssh` 登陆远程服务器，都会启动一个 `bash` 命令行给我们；
> * 每次 `tmux` 新开一个 `pane`，都会启动一个 `bash` 命令行给我们；
> * 所以未来所有新开的环境都会加载我们修改的内容。

### 2.4 常见环境变量

常见环境变量如下所示。

**1. `HOME`**

用户的家目录。

**2. `PATH`**

可执行文件（命令）的存储路径，路径与路径之间用 `:` 分隔。

当某个可执行文件同时出现在多个路径中时，会选择从左到右数第一个路径中的执行。**下列所有存储路径的环境变量，均采用从左到右的优先顺序。**

**3. `LD_LIBRARY_PATH`**

用于指定动态链接库（`.so` 文件）的路径，其内容是以冒号分隔的路径列表。

**4. `C_INCLUDE_PATH`**

C 语言的头文件路径，内容是以冒号分隔的路径列表。

**5. `CPLUS_INCLUDE_PATH`**

CPP 的头文件路径，内容是以冒号分隔的路径列表。

**6. `PYTHONPATH`**

Python 导入包的路径，内容是以冒号分隔的路径列表。

**7. `JAVA_HOME`**

jdk 的安装目录。

**8. `CLASSPATH`**

存放 Java 导入类的路径，内容是以冒号分隔的路径列表。