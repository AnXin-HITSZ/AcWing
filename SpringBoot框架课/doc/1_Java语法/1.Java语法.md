# 1. Java 语法

**目录：**

[TOC]

---

## 一、安装环境

**安装 IDEA：**

IDEA 下载：
1. 进入官方下载地址：[官方下载地址](https://www.jetbrains.com/zh-cn/idea/download/#section=windows)。
2. 下载专业版（Ultimate 版）。

## 二、基本概念

### 2.1 JDK、JRE、JVM 的关系

JDK：Java Develepment Kit，Java 开发工具包。

JRE：Java Runtime Environment，Java 运行环境。

JVM：Java Virtual Machine，Java 虚拟机。

> 注意：JDK 包含 JRE，JRE 包含 JVM。

### 2.2 JDK 版本选择

目前 JDK 1.8（也叫 JDK 8，注意不是 JDK 18）用得最多。

### 2.3 Java 代码的编译运行流程

1. 将 java 源码编译成 Java 字节码；
2. 使用 JVM 将 Java 字节码转化成机器码。

上述流程中，JVM 的作用：跨平台、内存管理、安全。

### 2.4 JSE、JEE、JME 的区别

JSE：Java Standard Edition，标准版。

JEE：Java Enterprise Edition，企业版。

JME：Java Micro Edition，移动版。

Spring 是 JEE 的轻量级替代品，而 SpringBoot 是 Spring + 自动化配置。

## 三、Java 语法

### 3.1 变量、运算符、输入与输出

类似于 C#，Java 的所有变量和函数都要定义在 `class` 中。

#### 3.1.1 内置数据类型（基本数据类型）

Java 的内置数据类型如下表所示：
| 类型 | 字节数 | 举例 |
| :--: | :--: | :--: |
| `byte` | 1 | `123` |
| `short` | 2 | `12345` |
| `int` | 4 | `123456789` |
| `long` | 8 | `1234567891011L` |
| `float` | 4 | `1.2F` |
| `double` | 8 | `1.2`、`1.2D` |
| `boolean` | 1 | `true`、`false` |
| `char` | 2 | `'A'` |

#### 3.1.2 常量

使用 `final` 修饰：
```java
final int N = 110;
```

#### 3.1.3 类型转化

显式转化：
```java
int x = (int)'A';
```

隐式转化只能由精度从低到高转化，而无法由精度从高到低转化：
```java
double x = 12, y = 4 * 3.3;
```

强制类型转化（即显式转化）可实现由精度从高到低转化。

#### 3.1.4 表达式

与 C++、Python3 类似：
```java
int a = 1, b = 2, c = 3;
int x = (a + b) * c;
x ++;
```

#### 3.1.5 输入

方式 1（效率较低，输入规模较小时使用）：
```java
Scanner sc = new Scanner(System.in);
String str = sc.next(); // 读入下一个字符串（不可以包含空格）
int x = sc.nextInt();   // 读入下一个整数
float y = sc.nextFloat();   // 读入下一个单精度浮点数
double z = sc.nextDouble(); // 读入下一个双精度浮点数
String line = sc.nextLine();    // 读入下一行（可以包含空格）
```

方式 2（效率较高，输入规模较大时使用；**注意需要抛异常！**）：
```java
package com.yxc;

import java.io.BufferedReader;
import java.io.InputStreamReader;

public class Main {
    public static void main(String[] args) throws Exception {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String str = br.readLine(); // 读入一整行
        int x = br.read();  // 读入一个字符
        System.out.println(str);
        System.out.println(x);

        // 读入一个整数
        String line = br.readLine();
        int y = Integer.parseInt(line);
        System.out.println(y);

        // 读入以空格作为分隔符的一行整数
        String[] strs = br.readLine().split(" ");
        int z1 = Integer.parseInt(strs[0]), z2 = Integer.parseInt(strs[1]);
        System.out.println(z1);
        System.out.println(z2);
    }
}

```

#### 3.1.6 输出

方式 1（效率较低，输出规模较小时使用）：
```java
System.out.println(123);    // 输出整数 + 换行
System.out.println("Hello World");  // 输出字符串 + 换行
System.out.print(123);    // 输出整数（不换行）
System.out.print("yxc\n");  // 输出字符串（不换行）
System.out.printf("%04d %.2f\n", 4, 123.456D);  // 格式化输出，float 与 double 都用 %f 输出
```

方式 2（效率较高，输出规模较大时使用；**注意需要抛异常！**）：
```java
package com.yxc;

import java.io.BufferedWriter;
import java.io.OutputStreamWriter;

public class Main {
    public static void main(String[] args) throws Exception {
        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
        bw.write("Hello World\n");
        bw.flush(); // 需要手动刷新缓冲区
    }
}

```

### 3.2 判断语句

#### 3.2.1 `if - else` 语句

与 C++、Python 中类似。

示例代码：
```java
package com.yxc;

import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int year = sc.nextInt();
        if (year % 100 == 0) {
            // 如果年份为整百
            if (year % 400 == 0)
                System.out.println("%d 是闰年\n", year);
            else
                System.out.println("%d 不是闰年\n", year);
        } else {
            // 如果年份不为整百
            if (year % 4 == 0)
                System.out.println("%d 是闰年\n", year);
            else
                System.out.println("%d 不是闰年\n", year);
        }
    }
}

```

#### 3.2.2 `switch` 语句

与 C++ 中类似。

示例代码：
```java
package com.yxc;

import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int day = sc.nextInt();
        String name;
        switch (day) {
            case 1:
                name = "Monday";
                break;
            case 2:
                name = "Tuesday";
                break;
            case 3:
                name = "Wednesday";
                break;
            case 4:
                name = "Thursday";
                break;
            case 5:
                name = "Friday";
                break;
            case 6:
                name = "Saturday";
                break;
            case 7:
                name = "Sunday";
                break;
            default:
                name = "not valid";
        }
        System.out.println(name);
        // Java 中字符串也可用 printf + %s 进行输出，例如：
        // System.out.printf("%s", name);
    }
}

```

#### 3.2.3 逻辑运算符与条件表达式

与 C++、Python 类似。

示例代码：
```java
package com.yxc;

import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int year = sc.nextInt();
        if (year % 100 != 0 && year % 4 == 0 || year % 400 == 0)
            System.out.println("%d 是闰年\n", year);
        else
            System.out.println("%d 不是闰年\n", year);
    }
}

```

### 3.3 循环语句

#### 3.3.1 `while` 循环

与 C++、Python 类似。

示例代码：
```java
int i = 0;
while (i < 5) {
    System.out.println(i);
    i++;
}
```

#### 3.3.2 `do while` 循环

与 C++、Python 类似。

示例代码：
```java
int i = 0;
do {
    System.out.println(i);
    i++;
} while (i < 5);
```

`do while` 语句与 `while` 语句非常相似。唯一的区别是：`do while` 语句限制在循环体后检查条件；因此不管条件的值如何，我们都要至少执行一次循环。

#### 3.3.3 `for` 循环

与 C++、Python 类似。

示例代码：
```java
for (int i = 0; i < 5; i++) {   // 普通循环
    System.out.println(i);
}

int[] a = {0, 1, 2, 3, 4};
for (int x: a) {    // forEach 循环
    System.out.println(x);
}

String[] strs = {"aaa", "bbb", "ccc"};
for (String str: strs) {    // forEach 循环
    System.out.println(str);
}
```

### 3.4 数组

Java 中的数组与 C++ 中的数组类似。

Java 中数组不可变长。

#### 3.4.1 初始化

与 C++ 类似。

初始化定长数组，长度可以是变量，可以在初始化时赋值。

示例代码：
```java
int[] a = new int[5];   // 初始化长度为 5 的 int 数组，初始值为 0
int n = 10;
float[] b = new float[n];   // 初始化长度为 n 的 float 数组，初始值为 0.0F
char[] c = {'a', 'b', 'c'}; // 初始化长度为 3 的 char 数组，初始值为：'a'、'b'、'c'
char[] d = c;   // d 与 c 地址相同，更改 c 中的元素，d 中的元素也会改变
```

> 注意：与 C++ 不同，Java 中不可使用字符数组代替字符串，即 Java 中的字符数组和字符串是完全独立且不同的；而 C++ 中可以使用字符数组表示字符串。

#### 3.4.2 数组元素的读取与写入

与 C++ 类似。

示例代码：
```java
int[] a = new int[5];

for (int i = 0; i < 5; i++) {
    a[i] = i;
}
for (int i = 0; i < 5; i++) {
    System.out.println(a[i] * a[i]);
}
```

#### 3.4.3 多维数组

与 C++ 类似。

示例代码：
```java
int[][] a = new int[2][3];
a[1][2] = 1;
int[][] b = {
    {1, 2, 3},
    {4, 5, 6},
};
System.out.println(a[1][2]);
System.out.println(b[0][1]);
```

#### 3.4.4 常用 API

**1. 属性 `length`**

返回数组长度。

> 注意：调用 `length` 属性时不加小括号。

**2. `Arrays.sort()`**

数组正序排序。

支持自定义函数排序，即可传入自己实现的排序函数以实现对该数组的排序。示例如下：
```java
Integer[] a = {2, 1, 5, 3, 4};

Arrays.sort(a, (x, y) -> y - x);
```

上述示例中，向 `Arrays.sort()` 函数传入待排序数组 `a` 以及匿名函数 `(x, y) -> (y - x)`，即可实现对数组 `a` 的逆序排序。

> 注意：
> 
> 此处需要使用 `int` 的引用数据类型 `Integer` 构造数组 `a`，即：
> ```java
> Integer[] a = {2, 1, 5, 3, 4};
> ```
> 
> 否则将会报错。

**3. `Arrays.fill(int[] a, int val)`**

填充数组。

**4. `Arrays.toString()`**

将**一维数组**转化为字符串。

**5. `Arrays.deepToString()`**

将**多维数组**转化为字符串。

### 3.5 字符串

#### 3.5.1 `String` 类

初始化：
```java
String a = "Hello World";
String b = "My name is";
String x = b;   // 存储到了相同地址
String c = b + "yxc";   // String 可以通过加号拼接
String d = "My age is " + 18;   // int 会被隐式转化成字符串 "18"
String str = String.format("My age is %d", 18); // 格式化字符串，类似于 C++ 中的 sprintf
String money_str = "123.45";
double money = Double.parseDouble(money_str);   // String 转 double
```

只读变量，不能修改。例如：
```java
String a = "Hello "
a += "World";   // 会构造一个新的字符串
```

访问 `String` 中的字符的方式如下：
```java
String str = "Hello World";
for (int i = 0; i < str.length(); i++) {
    System.out.print(str.charAt(i));    // 只能读取，不能写入
}
```

常用 API：
* `length()`：返回长度。
* `split(String regex)`：分割字符串。

> 注意：`split(String regex)` 函数支持传入正则表达式进行匹配分割。

* `indexOf(char c)`、`indexOf(String str)`：查找，找不到返回 `-1`。
* `equals()`：判断两个字符串是否相等，注意不能直接用 `==`。

> 注意：Java 中不能直接使用 `==` 判断两个字符串是否相等，而 `==` 将会判断两个字符串的地址值是否相同。

* `compareTo()`：判断两个字符串的字典序大小；负数表示小于，`0` 表示相等，正数表示大于。
* `startsWith()`：判断是否以某个前缀开头。
* `endsWith()`：判断是否以某个后缀结尾。
* `trim()`：去掉首尾的空白字符。
* `toLowerCase()`：全部用小写字符。
* `toUpperCase()`:全部用大写字符。
* `replace('char oldChar', 'char newChar')`：替换字符。
* `replace("String oldRegex", "String newRegex")`：替换字符串。
* `substring(int beginIndex, int endIndex)`：返回 `[beginIndex, endIndex)` 中的子串。

#### 3.5.2 `StringBuilder`、`StringBuffer`

`String` 不能被修改；如果打算修改字符串，可以使用 `StringBuilder` 和 `StringBuffer`。

`StringBuffer` 线程安全，速度较慢；`StringBuilder` 线程不安全，速度较快。

示例代码：
```java
StringBuilder sb = new StringBuilder("Hello "); // 初始化
sb.append("World"); // 拼接字符串
System.out.println(sb);

for (int i = 0; i < sb.length(); i++) {
    sb.setCharAt(i, (char)(sb.charAt(i) + 1));  // 读取和写入字符
}

System.out.println(sb);
```

常用 API：
* `reverse()`：翻转字符串。

### 3.6 函数

Java 的所有变量和函数都要定义在类中。

函数或变量前加 `static` 表示静态对象，类似于全局变量。
静态对象属于 `class`，而不属于 `class` 的具体实例。

静态函数中只能调用静态函数和静态变量。

示例代码：
```java
import java.util.Arrays;

public class Main {
    public static void main(String[] args) {
        System.out.println(max(3, 4));
        int[][] a = new int[3][4];
        fill(a, 3);
        System.out.println(Arrays.deepToString(b));
    }

    private static int max(int a, int b) {
        if (a > b) return a;
        return b;
    }

    private static void fill(int[][] a, int val) {
        for (int i = 0; i < a.length; i++)
            for (int j = 0; j < a[i].length; j++)
                a[i][j] = val;
    }

    private static int[][] getArray2d(int row, int col, int val) {
        int[][] a = new int[row][col];
        for (int i = 0; i < row; i++)
            for (int j = 0; j < col; j++)
                a[i][j] = val;
        return a;
    }
}

```

### 3.7 类与接口

#### 3.7.1 类

`class` 与 C++、Python 类似。

##### 3.7.1.1 源文件声明规则

源文件声明规则如下：
* 一个源文件中只能有一个 `public` 类。
* 一个源文件可以有多个非 `public` 类。
* 源文件的名称应该和 `public` 类的类名保持一致。
* 每个源文件中，先写 `package` 语句，再写 `import` 语句，最后定义类。

##### 3.7.1.2 类的定义

类的定义前可以有两种权限修饰符：
* `public`：所有对象均可以访问。
* `private`：只有自己可以访问。

示例代码：
```java
class Point {
    private int x;
    private int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public void setX(int x) {
        this.x = x;
    }

    public void setY(int y) {
        this.y = y;
    }

    public int getX() {
        return x;
    }

    public int getY() {
        return y;
    }

    public String toString() {
        return String.format("(%d, %d)", x, y);
    }
}

```

##### 3.7.1.3 类的继承

每个类只能继承一个类。

示例代码：
```java
class ColorPoint extends Point {
    private ColorPoint(int x, int y, String color) {
        super(x, y);
        this.color = color;
    }

    public void setColor(String color) {
        this.color = color;
    }

    public String toString() {
        return String.format("(%d, %d, %s)", super.getX(), super.getY(), this.color);
    }
}

```

##### 3.7.1.4 类的多态

示例代码：
```java
public class Main {
    public static void main(String[] args) {
        Point point = new Point(3, 4);
        Point colorPoint = new ColorPoint(1, 2, "red");

        // 多态，同一个类的实例，调用相同的函数，运行结果不同
        System.out.println(point.toString());
        System.out.println(colorPoint.toString());
    }
}

```

#### 3.7.2 接口

`interface` 与 `class` 类似。主要用来定义类中所需包含的函数。

接口也可以继承其他接口，一个类可以实现多个接口。

##### 3.7.2.1 接口的定义

示例代码：
```java
interface Role {
    public void greet();
    public void move();
    public int getSpeed();
}
```

##### 3.7.2.2 接口的继承

每个接口可以继承多个接口。

示例代码：
```java
interface Hero extends Role {
    public void attack();
}
```

##### 3.7.2.3 接口的实现

每个类可以实现多个接口。

示例代码：
```java
class Zeus implements Hero {
    private final String name = "Zeus";
    public void attack() {
        System.out.println(name + ": Attack!");
    }

    public void greet() {
        System.out.println(name + ": Hi!");
    }

    public void move() {
        System.out.println(name + ": Move!");
    }

    public int getSpeed() {
        return 10;
    }
}

```

##### 3.7.2.4 接口的多态

示例代码：
```java
class Athena implements Hero {
    private final String name = "Athena";
    public void attack() {
        System.out.println(name + ": Attack!");
    }

    public void greet() {
        System.out.println(name + ": Hi!");
    }

    public void move() {
        System.out.println(name + ": Move!");
    }

    public int getSpeed() {
        return 10;
    }
}

public class Main {
    public static void main(Stringp[] args) {
        Hero[] heros = {new Zeus(), new Athena()};
        for (Hero hero: heros) {
            hero.greet();
        }
    }
}

```

#### 3.7.3 泛型

类似于 C++ 的 `template`，Java 的类和接口也可以定义泛型，即同一套函数可以作用于不同的对象类型。

泛型只能使用对象类型，不能使用基本变量类型。