# 2. 配置 git 环境与项目创建

**目录：**

[TOC]

---

## 一、项目设计

本项目旨在设计一款蛇类机器人对战平台。

在项目中，每条蛇为一个 Bot，即为用户编写的一段行为代码；每个用户可以选择派出自己的一条蛇且最多派出一条蛇，目标为摧毁敌方的蛇。

### 1.1 项目名称

项目名称为 King of Bots，简称 KOB。

### 1.2 项目图标

![项目图标 1](./images/1_d7f3b93efd-kob.png "项目图标 1")

![项目图标 2](./images/1_535cd642fd-kob2.png "项目图标 2")

### 1.3 项目包含的模块

项目包含以下模块：
* PK 模块：匹配界面（微服务）、实况直播界面（WebSocket 协议）、真人 PK（WebSocket 协议）及聊天框。

> 注意：由于 HTTP 协议只能支持客户端向服务器发送请求而服务器无法向客户端发送请求的单向通信，因此我们需要使用支持双向通信的 WebSocket 协议来实现实况直播界面。

* 对局列表模块：对局列表界面、对局录像回放界面。
* 排行榜模块：Bot 排行榜界面。
* 用户中心模块：注册界面、登录界面、我的 Bot 界面、每个 Bot 的详情界面。

### 1.4 项目模式

项目采用前后端分离模式：
* SpringBoot 实现后端（Backend）。
  * Backend 需要 对接 MySQL、Redis、硬盘、微服务等。
* Vue3 实现 Web 端和 AcApp 端（即前端）。

Client 端向 Server 端发送 url，Server 向 Client 端返回消息（该消息可以近似看成字符串），浏览器负责将该消息解释成页面并展示给用户；其本质上是函数调用。

> 前后端的实现分为前后端不分离和前后端分离两种模式。如果渲染（即近似字符串拼接的过程）是在用户浏览器中进行的，即为前后端分离模式；如果渲染是在服务器端直接进行的，即为前后端不分离模式。

## 二、配置 git 环境

> 为什么需要 git？
> 1. 存档；
> 2. 同步不同机器上的代码。

配置 git 环境步骤如下：
1. 安装 Git Bash（使用 Mac 和 Linux 的同学可以跳过这一步）：[Git 官方网站](https://gitforwindows.org/)。
2. 进入家目录生成密钥：执行命令 `ssh-keygen`。
3. 在 AC Git 上注册账号，地址：[AC Git 官方网址](https://git.acwing.com/)。
4. 将 `id_rsa.pub` 的内容复制到 AC Git 上。

## 三、创建项目后端

> 注意：如果 `https://start.spring.io/` 加载慢的话，可以换成：`https://start.aliyun.com`。

## 四、创建项目 Web 端与 AcApp 端

> VSCode 下载地址：[VSCode 下载地址](https://code.visualstudio.com/)。

以下介绍 Vue3 中该项目使用到的部分。

> 注意：我们在 Vue 中编写的所有代码，都将会在用户的浏览器上执行，而不是在后端中执行。

### 4.1 配置环境

> Vue 官网：[Vue 官网](https://vuejs.org/)。

#### 4.1.1 终端

Linux 和 Mac 上可以用自带的终端。

Windows 上推荐用 powershell 或者 cmd。Git Bash 有些指令不兼容。

#### 4.1.2 安装 Nodejs

Nodejs 安装地址：[Nodejs 安装地址](https://nodejs.org/en/)。

#### 4.1.3 安装 @vue/cli

打开 Git Bash，执行：
```bash
npm i -g @vue/cli
```

如果执行后面的操作有 bug，可能是最新版有问题，可以尝试安装早期版本，比如：`npm i -g @vue/cli@4`。

#### 4.1.4 启动 vue 自带的图形化项目管理界面

启动方式：
```bash
vue ui
```

> 注意：
>
> 常见问题 1：Windows 上运行 vue，提示无法加载文件，表示用户权限不足。
> * 解决方案：**用管理员身份**打开终端，输入 `set-ExecutionPolicy RemoteSigned`，然后输入 `y`。
>
> 常见问题 2：Windows 上执行 `vue ui` 命令后，可以成功进入 Vue 项目管理器，但进入“创建”和“导入”选项后页面将会一直加载而无法成功展示。
> * 解决方案：使用组合键 `Win + R` 输入 `cmd` 运行 `cmd.exe`（即命令提示符，且**请勿以管理员身份运行命令提示符！**），在 `cmd.exe` 中执行 `vue ui` 命令即可成功快速完成加载。

### 4.2 基本概念

#### 4.2.1 script 部分

`export default` 对象的属性：
* `name`：组件的名称。
* `components`：存储 `<template>` 中用到的所有组件。
* `props`：存储父组件传递给子组件的数据。
* `watch()`：当某个数据发生变化时触发。
* `computed`：动态计算某个数据。
* `setup(props, context)`：初始化变量、函数。
  * `ref` 定义变量，可以用 `.value` 属性重新赋值。
  * `reactive` 定义对象，不可重新赋值。
  * `props` 存储父组件传递过来的数据。
  * `context.emit()`：触发父组件绑定的函数。

#### 4.2.2 template 部分

* `<slot></slot>`：存放父组件传过来的 `children`。
* `v-on:click` 或 `@click` 属性：绑定事件。
* `v-if`、`v-else`、`v-else-if` 属性：判断。
* `v-for` 属性：循环，`:key` 循环的每个元素需要有唯一的 `key`。
* `v-bind:` 或 `:`：绑定属性。

#### 4.2.3 style 部分

* `<style>` 标签添加 `scope` 属性后，不同组件间的 css 不会相互影响。

#### 4.2.4 第三方组件

* `view-router` 包：实现路由功能。
* `vuex`：存储全局状态，全局唯一。
  * `state`：存储所有数据，可以用 `modules` 属性划分成若干模块。
  * `getters`：根据 `state` 中的值计算新的值。
  * `mutations`：所有对 `state` 的修改操作都需要定义在这里，不支持异步，可以通过 `$store.commit()` 触发。
  * `actions`：定义对 `state` 的复杂修改操作，支持异步，可以通过 `$store.dispatch()` 触发。注意不能直接修改 `state`，只能通过 `mutations` 修改 `state`。
  * `modules`：定义 `state` 的子模块。

### 4.3 课上项目的 API

**1. 获取 Json Web Token（JWT）**
* 地址：[地址](https://app165.acapp.acwing.com.cn/api/token/)。
* 方法：`POST`。
* 是否验证 jwt：否。
* 输入参数：
  * `username`：用户名。
  * `password`：密码。
* 返回结果：
  * `access`：访问令牌，有效期 5 分钟。
  * `refresh`：刷新令牌，有效期 14 天。

**2. 刷新 JWT 令牌**
* 地址：[地址](https://app165.acapp.acwing.com.cn/api/token/refresh/)。
* 方法：`POST`。
* 是否验证 jwt：否。
* 输入参数：
  * `refresh`：刷新令牌。
* 返回结果：
  * `access`：访问令牌，有效期 5 分钟。

**3. 获取用户列表**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/userlist/)。
* 方法：`GET`。
* 是否验证 jwt：否。
* 输入参数：无。
* 返回结果：返回 10 个用户的信息。

**4. 获取某个用户的信息**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/getinfo/)。
* 方法：`GET`。
* 是否验证 jwt：是。
* 输入参数：
  * `user_id`：用户的 ID。
* 返回结果：该用户的信息。

**5. 获取某个用户的所有帖子**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/post/)。
* 方法：`GET`。
* 是否验证 jwt：是。
* 输入参数：
  * `user_id`：用户的 ID。
* 返回结果：该用户的所有帖子。

**6. 创建一个帖子**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/post/)。
* 方法：`POST`。
* 是否验证 jwt：是。
* 输入参数：
  * `content`：帖子的内容。
* 返回结果：`result: success`。

**7. 删除一个帖子**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/post/)。
* 方法：`DELETE`。
* 是否验证 jwt：是。
* 输入参数：
  * `post_id`：被删除帖子的 ID。
* 返回结果：`result: success`。

**8. 更改关注状态**
如果未关注，则关注；如果已关注，则取消关注。
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/follow/)。
* 方法：`POST`。
* 是否验证 jwt：是。
* 输入参数：
  * `target_id`：被关注的用户 ID。
* 返回结果：`result: success`。

**9. 注册账号**
* 地址：[地址](https://app165.acapp.acwing.com.cn/myspace/user/)。
* 方法：`POST`。
* 是否验证 jwt：否。
* 输入参数：
  * `username`：用户名。
  * `password`：密码。
  * `password_confirm`：确认密码。
* 返回结果：
  * `result: success`。
  * `result: 用户名和密码不能为空`。
  * `result: 两个密码不一致`。
  * `result: 用户名已存在`。

## 五、在 SpringBoot 中解决跨域问题

当前后端的域名中的端口号不一致时，将会出现跨域问题，这是浏览器的安全机制。

解决方法如下。

在 `config` 包下添加配置类：`CorsConfig`。

```java
package com.kob.backend.config;

/**
 * ClassName: CorsFilterConfig
 * Package: com.kob.backend.config
 * Description:
 *
 * @Author AnXin
 * @Create 2026/1/13 12:14
 * @Version 1.0
 */

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import org.springframework.web.filter.CorsFilter;

import java.util.Collections;

@Configuration
public class CorsFilterConfig {
    @Bean
    public CorsFilter corsFilter() {
        // 1. 配置跨域规则
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowedOriginPatterns(Collections.singletonList("*"));
        config.addAllowedHeader(CorsConfiguration.ALL);
        config.addAllowedMethod(CorsConfiguration.ALL);
        config.setAllowCredentials(true);
        config.setMaxAge(3600L);

        // 2. 绑定路径
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config); // 所有路径应用规则

        // 3. 返回CorsFilter
        return new CorsFilter(source);
    }
}

```

## 六、素材

### 6.1 背景图片

![背景图片](./images/1_59b8f162fd-background.png "背景图片")